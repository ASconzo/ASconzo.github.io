<!DOCTYPE html>
<html>
	<head>
		<title>Alex Sconzo | Projects</title>
		<link rel="stylesheet" href="../styles.css" />
		<meta charset="UTF-8">
		<link rel="icon" type="image/x-icon" href="../favicon.ico">
	</head>

	<body>

		<div class="wrap">
			<div class="sidenav">
				<a href = "../index.html">
					<figure class="figure">
						<img src="../pictures/Win2k-MyComputer.png" alt="Home Icon" style="max-width:64px">
						<figcaption>Home</figcaption>
					</figure>
				</a>
				<a href = "../news.html">
					<figure class="figure">
						<img src="../pictures/Win2k-Internet.png" alt="News Icon" style="max-width:64px">
						<figcaption>News</figcaption>
					</figure>
				</a>
				<a href = "../about.html">
					<figure class="figure">
						<img src="../pictures/Win2k-About.png" alt="About Icon" style="max-width:64px">
						<figcaption>About</figcaption>
					</figure>
				</a>
				<a href = "../projects.html">
					<figure class="figure">
						<img src="../pictures/Win2k-Paint.png" alt="Projects Icon" style="max-width:64px">
						<figcaption>Projects</figcaption>
					</figure>
				</a>
				<a href = "../blog.html">
					<figure class="figure">
						<img src="../pictures/Win2k-Notepad.png" alt="Blog Icon" style="max-width:64px">
						<figcaption>Blog</figcaption>
					</figure>
				</a>
			</div>

			<div class="main">
				
				<script>
					var expressionString = "";
					
					function extendExpression(currentItem) {
						expressionString = expressionString + currentItem;
						document.getElementById("calcSpace").innerHTML = expressionString;
					}
										
					function updateLine(expression, left, right){
						newLine = "<br> = " + left.join(" ") + expression.join(" ") + right.join(" ");
						extendExpression(newLine);
					}
					
					function resetExpression(){
						expressionString = "";
						document.getElementById("calcSpace").innerHTML = "Use the buttons below to enter your commands!";
						left = [];
						right = [];
						expression = [];
					}
					
					function isOperator(operator){
						var operatorList = ["+", "-", "/", "*", "^"];
						return operatorlist.includes(operator);
					}
					
					function isDigit(character) {
						var digitList = ["." , "0", "1",  "2", "3", "4", "5", "6", "7", "8", "9"];
						return digitList.includes(character);				
					}
					
					function stringToExpression(stringInput){
						var newExpression = [];
						var tempString = "";
						for (let item of stringInput){
							if (isDigit(item)){
								//Append item to tempString, if it is an integer or a ".".
								tempString = tempString + item;
							}else{ // If item is "+", "-", "*", "/", "^", "(", or ")"
								if (tempString != ""){
									//If tempstring has contents, we'll push that to newExpression array
									newExpression.push(parseFloat(tempString));
								}
								tempString = ""; //Reset tempString
								newExpression.push(item); //This pushes to operator to the array
							}
						}
						if (tempString != ""){
							newExpression.push(parseFloat(tempString));
							var item = "debug";
						} 
						tempString = '';
						return newExpression;
					}
					
					function evaluateExpression(expression, left, right){
					updateLine(expression, left, right);
					console.log("Input array:");
					console.log(expression);
						
					//Part 1: Process parentheticals
					//Part 1.1: Add multiplication signs before and after parentheticals
					addMultiplications(expression, left, right);
							
					//Part 1.2: Do the math inside parentheticals
					processParentheticals(expression, left, right);						
					//Part 2: Evaluate math
							
					//Part 2.0: Check for negative numbers
					// -(5+1) --> (-1)*(5+1)
					adjustNegatives(expression, left, right);
						
					//Part 2.1: Evaluate exponents
					console.log("Calculating exponents");
					evaluateOperation(expression, ["^"], [exponentiation], left, right);
					console.log("Finished calculating exponents.");

					//Part 2.2 Evaluate multiplication and Division
					console.log("Calculating multiplication and division: ");
					evaluateOperation(expression, ["*","/"], [multiplication, division], left, right);
					console.log("Finished calculating multiplication and division");

					//Part 2.3: Evaluate addition and subtraction
					console.log("Calculating addition and subtraction: ");
					evaluateOperation(expression, ["+","-"], [addition, subtraction], left, right);
					console.log("Finished calculating addition and subtraction");
					return expression;
					}
					
					function addMultiplications(expression,left, right){
						console.log("Adding multiplication signs around parentheticals");
						for (var i=0; i<expression.length; i++){
							if (i>0 && expression[i] === "(" && !isOperator(expression[i-1])){
								console.log(expression);
								expression.splice(i, 0, "*");
								console.log(expression);
								i=-1;
								updateLine(expression, left, right);
								continue;
							}
							if (i<expression.length-1 && expression[i] === ")" && !isOperator(expression[i+1])){
								console.log(expression);
								expression.splice(i+1, 0, "*");
								console.log(expression);
								i=-1;
								updateLine(expression, left, right);
								continue;
							}
							if (i<expression.length-1 && expression[i] === ")" && expression[i+1] === "("){
								console.log(expression);
								expression.splice(i+1, 0, "*");
								console.log(expression);
								i=-1;
								updateLine(expression, left, right);
								continue;
							}
						}
						console.log("Finished adding multiplication signs around parentheticals.");
						console.log(expression);
					}
					
					function processParentheticals(expression, left, right){
						console.log("Processing math inside the parentheticals:");
						while (expression.lastIndexOf("(") != -1){
							//var loopNum = i+1;
							//console.log("Loop # " + loopNum + " out of " + expression.length);
							//Locate indexes of left and right parentheticals. Will be -1 if there is none
							var leftParenIndex = expression.lastIndexOf("("); 
							var rightParenIndex= expression.indexOf(")", leftParenIndex);
							if (leftParenIndex != -1){
								console.log("Section contained within parentheticals found.");
								var removalLength = rightParenIndex - leftParenIndex + 1;
								var parentheticalExpression = expression.slice(leftParenIndex + 1, rightParenIndex);
								var leftArray = expression.slice(0, leftParenIndex+1);
								console.log("Left array: " + leftArray);
								var rightArray = expression.slice(rightParenIndex);
								console.log("Right array: " + rightArray);
								console.log("Middle array: " + parentheticalExpression);
								console.log("Solving parenthetical section");
								console.log("Before:");
								console.log(parentheticalExpression);
								var newArray = evaluateExpression(parentheticalExpression, leftArray, rightArray);
								console.log("Parenthetical section solved.");
								console.log("After:");
								console.log(newArray);
								console.log("Replacing old parenthetical section with answer.");
								console.log("Before:");
								console.log(expression);
								expression.splice(leftParenIndex,removalLength, newArray[0]);
								left = [];
								right = [];
								updateLine(expression, left, right);
								console.log("After:");
								console.log(expression);
							}
						}
					}
					
					function adjustNegatives(expression, left, right){
						console.log("Checking for the input of negative numbers");
						// If expression[0] is "-", and expression[1] is a number, make expression[1] negative
						if (expression[0] == "-" && !isOperator(expression[1])){
							var negatedNum = expression[1]*-1;
							expression.splice(0,2, negatedNum);
						}
						// If expression[i] is "-", and expression [i-1] is an operator, make the following number negative
						// So 5+-4, [5, "+", "-", 4] --> [5, "+", -4]
						for(var i=0; i<expression.length; i++){ 
							if (expression[i] == "-" && isOperator(expression[i-1])){
								var negatedValue = expression[i+1]*-1;
								expression.splice(i,2,negatedValue);
								i=-1;
								updateLine(expression, left, right);
								continue;
							}
						}
					}
					
					function evaluateOperation(expression, operators, operatorFunctions, left, right){
						for (var i = 0; i<expression.length; i++){
							for (var j = 0; j<operators.length; j++){
								if (expression[i] === operators[j]){
									var a = expression[i-1];
									var b = expression[i+1];
									var answer = operatorFunctions[j](a,b);
									console.log(a + operators[j] + b + "=" + answer); 
									expression.splice(i-1,3,answer);
									updateLine(expression, left, right);
									console.log(expression);
									i = -1;
									break;
								}
							}
						}
					}
					
					function addition(a,b){
						return a+b;
					}
					function subtraction(a,b){
						return a-b;
					}
					function multiplication(a,b){
						return a*b;
					}
					function division(a,b){
						return a/b;
					}
					function exponentiation(a,b){
						return Math.pow(a, b);
					}
				</script>
				
				<section class="bluebox" id="top">
					<h1 style="text-align:center;">Alex Sconzo | Projects</h1>
					<p><i><a href = "../homepage.html">Home</a> > <a href="../projects.html">Projects</a> > </i> <strong>Javascript Calculator</strong></p>
					<hr>
					<div>
						<h2>Javascript Calculator</h2>
						<hr>
						<style>
							.grid-container{
								display: grid;
								grid-template-columns: auto auto auto auto auto;
								gap: 10px;
								background-color: rgb(0, 163, 225);
								padding: 10px;
								border: ridge gold;
							}
							.grid-container > button {
								background-color: rgb(0,103,165);
								border: ridge gold;
								text-align: center;
								font-size: 30px;
								color: inherit;
							}
							.grid-container > button:hover{
								background-color:#fff7cc;
								color:black;
								cursor: pointer;
							}
							.grid-container >button:active{
								background-color:gold;
								border: inset gold;
							}
							#calcSpace{
								grid-column: 1/6;
							}
							
						</style>
						<div class="grid-container">
							<div id="calcSpace" style="background-color: white; border: ridge gold; color:black; text-align:left; font-size: 30px;">Use the buttons below to enter your commands!</div>
							<button type="button" onclick="extendExpression('1')">1</button>
							<button type="button" onclick="extendExpression('2')">2</button>
							<button type="button" onclick="extendExpression('3')">3</button>
							<button type="button" onclick="extendExpression('+')">+</button>
							<button type="button" onclick="extendExpression('^')">^</button>
							<button type="button" onclick="extendExpression('4')">4</button>
							<button type="button" onclick="extendExpression('5')">5</button>
							<button type="button" onclick="extendExpression('6')">6</button>
							<button type="button" onclick="extendExpression('-')">-</button>
							<button type="button" onclick="extendExpression('(')">(</button>
							<button type="button" onclick="extendExpression('7')">7</button>
							<button type="button" onclick="extendExpression('8')">8</button>
							<button type="button" onclick="extendExpression('9')">9</button>
							<button type="button" onclick="extendExpression('*')">*</button>
							<button type="button" onclick="extendExpression(')')">)</button>
							<button type="button" id="clear" style="background-color:indianred"
									onclick="resetExpression()">C</button>
							<button type="button" onclick="extendExpression('0')">0</button>
							<button type="button" onclick="extendExpression('.')">.</button>
							<button type="button" onclick="extendExpression('/')">/</button>
							<button type="button" id="equals" style="background-color:green"
									onclick="evaluateExpression(stringToExpression(expressionString),[],[])">=</button>
											
						</div>
						<!--"evaluateExpression(stringToExpression(expressionString),[],[])" -->
							
					</div>
					<p>
						This is a simple calculator programmed in Javascript. See my <a href = "#">Blog Post</a> where I write about it!<br>
						This calculator is feature-complete. It can add, subtract, multiply, divide, and calculate exponents. It can even calculate parentheticals, which I am very proud of. The program uses recursion to step down inside the parentheses and retrieve the answer. Give it a try!
					</p>
					
				</section>
			</div>

			<div style = "width: 160px;"><!-- I'm empty!, I exist to space out the flexbox more evenly --></div>

		</div>

		<br><br><br>
		<section class="bluebox">
			<p style="text-align:center"><i>All images retrieved from the Internet, except for the ones created by me. I do not claim ownership over any images used on this page, except for the ones created by me. Rights are reserved by their respective owners. Content written by me, 2024</i></p>
		</section>
	</body>
</html>